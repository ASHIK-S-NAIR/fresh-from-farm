{"ast":null,"code":"import _asyncToGenerator from\"F:/mern/projects/greenbeans/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"F:/mern/projects/greenbeans/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"F:/mern/projects/greenbeans/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"F:/mern/projects/greenbeans/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"F:\\\\mern\\\\projects\\\\greenbeans\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState}from\"react\";import{useParams,useNavigate}from\"react-router-dom\";import{isAuthenticated,logout}from\"../auth\";import{changePassword}from\"../user\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Settings=function Settings(){var _useParams=useParams(),userId=_useParams.userId;var _isAuthenticated=isAuthenticated(),user=_isAuthenticated.user,token=_isAuthenticated.token;var navigate=useNavigate();var _useState=useState({oldPassword:\"\",newPassword:\"\",confirmPassword:\"\",error:\"\",loading:\"\",success:false}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var oldPassword=values.oldPassword,newPassword=values.newPassword,confirmPassword=values.confirmPassword,error=values.error,loading=values.loading,success=values.success;var handleChange=function handleChange(name){return function(event){setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},name,event.target.value)));};};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();setValues(_objectSpread(_objectSpread({},values),{},{loading:\"loading\"}));if(oldPassword&&newPassword&&confirmPassword){_context.next=4;break;}return _context.abrupt(\"return\",setValues(_objectSpread(_objectSpread({},values),{},{loading:\"\",success:false,error:\"Fill all the fields\"})));case 4:if(!(oldPassword.length<6||newPassword.length<6||confirmPassword<6)){_context.next=7;break;}console.log(\"Password must have atleast 6 characters\");return _context.abrupt(\"return\",setValues(_objectSpread(_objectSpread({},values),{},{loading:\"\",success:false,error:\"password must be at least 6 characters\"})));case 7:if(newPassword===confirmPassword){_context.next=9;break;}return _context.abrupt(\"return\",setValues(_objectSpread(_objectSpread({},values),{},{loading:\"\",success:false,error:\"Password confirmation does not match\"})));case 9:_context.prev=9;_context.next=12;return changePassword(userId,token,{oldPassword:oldPassword,newPassword:newPassword});case 12:data=_context.sent;if(!data.error){_context.next=16;break;}console.log(data.error);return _context.abrupt(\"return\",setValues(_objectSpread(_objectSpread({},values),{},{loading:\"\",success:false,error:data.error})));case 16:console.log(\"Success\");setValues(_objectSpread(_objectSpread({},values),{},{success:true,loading:\"\",error:\"\"}));logout(function(){return navigate(\"/\");});_context.next=24;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](9);console.log(_context.t0);case 24:case\"end\":return _context.stop();}}},_callee,null,[[9,21]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var errorMessage=function errorMessage(){return/*#__PURE__*/_jsxs(\"div\",{className:\"errorMessage-sec\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"errorMessage-cross-sec\",onClick:function onClick(){return setValues(_objectSpread(_objectSpread({},values),{},{error:\"\"}));},children:[/*#__PURE__*/_jsx(\"div\",{className:\"errorMessage-cross-one\"}),/*#__PURE__*/_jsx(\"div\",{className:\"errorMessage-cross-two\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"errorMessage-msg-sec\",children:/*#__PURE__*/_jsx(\"p\",{className:\"errorMessage-msg\",children:error})})]});};var successMessage=function successMessage(){return/*#__PURE__*/_jsxs(\"div\",{className:\"errorMessage-sec\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"errorMessage-cross-sec\",onClick:function onClick(){return setValues(_objectSpread(_objectSpread({},values),{},{success:false}));},children:[/*#__PURE__*/_jsx(\"div\",{className:\"errorMessage-cross-one\"}),/*#__PURE__*/_jsx(\"div\",{className:\"errorMessage-cross-two\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"errorMessage-msg-sec\",children:/*#__PURE__*/_jsx(\"p\",{className:\"errorMessage-msg\",children:error})})]});};return/*#__PURE__*/_jsxs(\"section\",{className:\"userBoard-right-section accounts-section\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"userBoard-right-header\",children:\"Settings\"}),/*#__PURE__*/_jsx(\"div\",{className:\"userBoard-right-subSec\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"userBoard-righ-subsec-small\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"userBoard-right-subHead\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"userBoard-subHeader\",children:\"Change Password\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"userBoard-right-subInner\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"userBoard-right-single-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"userBoard-right-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"userBoard-right-label\",children:\"Old Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"userBoard-right-input\",onChange:handleChange(\"oldPassword\"),value:oldPassword})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"userBoard-right-single-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"userBoard-right-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"userBoard-right-label\",children:\"New Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"userBoard-right-input\",onChange:handleChange(\"newPassword\"),value:newPassword})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"userBoard-right-single-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"userBoard-right-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"userBoard-right-label\",children:\"Confirm Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"userBoard-right-input\",onChange:handleChange(\"confirmPassword\"),value:confirmPassword})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"userBoard-right-btn\",onClick:onSubmit,children:\"Change\"})]})]})}),error&&errorMessage(),success&&successMessage()]});};export default Settings;","map":{"version":3,"sources":["F:/mern/projects/greenbeans/client/src/core/Settings.js"],"names":["React","useState","useParams","useNavigate","isAuthenticated","logout","changePassword","Settings","userId","user","token","navigate","oldPassword","newPassword","confirmPassword","error","loading","success","values","setValues","handleChange","name","event","target","value","onSubmit","preventDefault","length","console","log","data","errorMessage","successMessage"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport { isAuthenticated, logout } from \"../auth\";\r\nimport { changePassword } from \"../user\";\r\n\r\nconst Settings = () => {\r\n  const { userId } = useParams();\r\n\r\n  const { user, token } = isAuthenticated();\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const [values, setValues] = useState({\r\n    oldPassword: \"\",\r\n    newPassword: \"\",\r\n    confirmPassword: \"\",\r\n    error: \"\",\r\n    loading: \"\",\r\n    success: false,\r\n  });\r\n\r\n  const { oldPassword, newPassword, confirmPassword, error, loading, success } =\r\n    values;\r\n\r\n  const handleChange = (name) => (event) => {\r\n    setValues({ ...values, [name]: event.target.value });\r\n  };\r\n\r\n  const onSubmit = async (event) => {\r\n    event.preventDefault();\r\n    setValues({ ...values, loading: \"loading\" });\r\n\r\n    if (!(oldPassword && newPassword && confirmPassword)) {\r\n      return setValues({\r\n        ...values,\r\n        loading: \"\",\r\n        success: false,\r\n        error: \"Fill all the fields\",\r\n      });\r\n    }\r\n\r\n    if (\r\n      oldPassword.length < 6 ||\r\n      newPassword.length < 6 ||\r\n      confirmPassword < 6\r\n    ) {\r\n      console.log(\"Password must have atleast 6 characters\");\r\n      return setValues({\r\n        ...values,\r\n        loading: \"\",\r\n        success: false,\r\n        error: \"password must be at least 6 characters\",\r\n      });\r\n    }\r\n\r\n    if (!(newPassword === confirmPassword)) {\r\n      return setValues({\r\n        ...values,\r\n        loading: \"\",\r\n        success: false,\r\n        error: \"Password confirmation does not match\",\r\n      });\r\n    }\r\n\r\n    try {\r\n      var data = await changePassword(userId, token, {\r\n        oldPassword,\r\n        newPassword,\r\n      });\r\n\r\n      if (data.error) {\r\n        console.log(data.error);\r\n        return setValues({\r\n          ...values,\r\n          loading: \"\",\r\n          success: false,\r\n          error: data.error,\r\n        });\r\n      }\r\n\r\n      console.log(\"Success\");\r\n      setValues({ ...values, success: true, loading: \"\", error: \"\" });\r\n      logout(() => navigate(\"/\"));\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  const errorMessage = () => {\r\n    return (\r\n      <div className=\"errorMessage-sec\">\r\n        <div\r\n          className=\"errorMessage-cross-sec\"\r\n          onClick={() => setValues({ ...values, error: \"\" })}\r\n        >\r\n          <div className=\"errorMessage-cross-one\"></div>\r\n          <div className=\"errorMessage-cross-two\"></div>\r\n        </div>\r\n        <div className=\"errorMessage-msg-sec\">\r\n          <p className=\"errorMessage-msg\">{error}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  const successMessage = () => {\r\n    return (\r\n      <div className=\"errorMessage-sec\">\r\n        <div\r\n          className=\"errorMessage-cross-sec\"\r\n          onClick={() => setValues({ ...values, success: false })}\r\n        >\r\n          <div className=\"errorMessage-cross-one\"></div>\r\n          <div className=\"errorMessage-cross-two\"></div>\r\n        </div>\r\n        <div className=\"errorMessage-msg-sec\">\r\n          <p className=\"errorMessage-msg\">{error}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <section className=\"userBoard-right-section accounts-section\">\r\n      <h1 className=\"userBoard-right-header\">Settings</h1>\r\n      <div className=\"userBoard-right-subSec\">\r\n        <div className=\"userBoard-righ-subsec-small\">\r\n          <div className=\"userBoard-right-subHead\">\r\n            <h2 className=\"userBoard-subHeader\">Change Password</h2>\r\n          </div>\r\n          <div className=\"userBoard-right-subInner\">\r\n            <div className=\"userBoard-right-single-group\">\r\n              <div className=\"userBoard-right-group\">\r\n                <label className=\"userBoard-right-label\">Old Password</label>\r\n                <input\r\n                  type=\"password\"\r\n                  className=\"userBoard-right-input\"\r\n                  onChange={handleChange(\"oldPassword\")}\r\n                  value={oldPassword}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"userBoard-right-single-group\">\r\n              <div className=\"userBoard-right-group\">\r\n                <label className=\"userBoard-right-label\">New Password</label>\r\n                <input\r\n                  type=\"password\"\r\n                  className=\"userBoard-right-input\"\r\n                  onChange={handleChange(\"newPassword\")}\r\n                  value={newPassword}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"userBoard-right-single-group\">\r\n              <div className=\"userBoard-right-group\">\r\n                <label className=\"userBoard-right-label\">\r\n                  Confirm Password\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  className=\"userBoard-right-input\"\r\n                  onChange={handleChange(\"confirmPassword\")}\r\n                  value={confirmPassword}\r\n                />\r\n              </div>\r\n            </div>\r\n            <button className=\"userBoard-right-btn\" onClick={onSubmit}>\r\n              Change\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {error && errorMessage()}\r\n      {success && successMessage()}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Settings;\r\n"]},"metadata":{},"sourceType":"module"}